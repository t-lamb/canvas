
<html>
<head>
	<title>Cursor Party</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script type="text/javascript" src="/socket.io/socket.io.js"></script>
	<script type="text/javascript">
		var socket = io.connect('http://45.55.43.235:8081/');

		socket.on('connect', function(){
			console.log("Connected on port 8081.")
		});

		//receive from any event
		socket.on('othermouse', function(data){
			console.log(data.x + " " + data.y);
			odraw(data.x,data.y);
		});

		function sendmouse(xval, yval) {
			console.log("sendmouse: " + xval + " " + yval);
			socket.emit('othermouse', { x: xval, y: yval });
		};

		var canvas;
		var context;

		function initcanvas() {
			canvas = document.getElementById('mycanvas');
			context = canvas.getContext('2d');
			
			context.canvas.width = window.innerWidth;
			context.canvas.height = window.innerHeight;
			context.fillStyle = "#FFFFFF";
			context.fillRect(0,0,canvas.width,canvas.height);

			canvas.addEventListener('mousemove', function (e){
				console.log("mousemove " + e.clientX + ", " + e.clientY);

				x = e.clientX;
				y = e.clientY;

				console.log("mousemove x:" + x + " y:" + y);

				sendmouse(x,y);
				draw(x,y);
			}, false);
		};

		function draw(xval, yval) {
			console.log("draw " + xval + " " + yval);

			// Draw a rectangle at clientX and clientY
			context.fillRect(xval, yval, 10,10);
			context.fillStyle='#000000';

		};

		// var opx = 0;
		// var opy = 0;

		function odraw(xval, yval){
			console.log("draw " + xval + " " + yval);

			// Draw a rectangle at other's X and other's Y
			context.fillRect(xval, yval, 10,10);
			context.fillStyle='#000000';

			// ontext.beginPath();

			// context.strokeStyle='#000000';

			// context.moveTo(opx, opy);
			// context.lineTo(xval, yval);

			// context.stroke();

			// opx = xval;
			// opy = yval;
		};

	</script>
</head>
<body onload="initcanvas();">
	<header>
		cursor party!
	</header>
	<canvas id="mycanvas" />
</body>
</html>
