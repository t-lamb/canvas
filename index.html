
<html>
<head>
	<script type="text/javascript" src="/socket.io/socket.io.js"></script>
	<script type="text/javascript">
		var socket = io.connect('http://45.55.43.235:8081/');

		socket.on('connect', function(){
			console.log("Connected on port 8081.")
		});

		//receive from any event
		socket.on('othermouse', function(data){
			console.log(data.x + " " + data.y);
			odraw(data.x,data.y);
		});

		function sendmouse(xval, yval) {
			console.log("sendmouse: " + xval + " " + yval);
			socket.emit('othermouse', { x: xval, y: yval });
		};

		var canvas;
		var context;

		function initcanvas() {
			canvas = document.getElementById('mycanvas');
			context = canvas.getContext('2d');
			
			context.fillStyle="#FF0000";
			context.fillRect(0,0,canvas.width,canvas.height);

			canvas.addEventListener('mousemove', function (evt){
				console.log("mousemove " + evt.clientX + evt.clientY);
				//evt.clientX and evt.clientY are for entire window, not just canvas

				//get size of canvas
				var canvasRect = canvas.getBoundingClientRect();

				//calculate x and y within canvas, not entire window
				y = evt.clientY - canvasRect.top; //subtract the starting point of the canvas top
				x = evt.clientX - canvasRect.left; //subtract the starting point of the canvas left

				console.log("mousemove x:" + x + " y:" + y);

				sendmouse(x,y);
				draw(x,y);
			}, false);
		};

		var px = 0;
		var py = 0;

		function draw(xval, yval) {
			console.log("draw " + xval + " " + yval);

			context.beginPath();

			context.strokeStyle='#000000';
			context.moveTo(px,py);
			context.lineTo(xval,yval);

			context.stroke();

			px = xval;
			py = yval;
		};

		var opx = 0;
		var opy = 0;

		function odraw(xval, yval){
			console.log("draw " + xval + " " + yval);

			ontext.beginPath();

			context.strokeStyle='#000000';

			context.moveTo(opx, opy);
			context.lineTo(xval, yval);

			context.stroke();

			opx = xval;
			opy = yval;
		};

	</script>
</head>
<body onload="initcanvas();">
	<canvas width="600" height="600" id="mycanvas" />
</body>
</html>
